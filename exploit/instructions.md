# Instructions d'Exploitation - Démonstration JWT Attack

## Prérequis

- Python 3 avec `PyJWT` : `pip install pyjwt`
- Hashcat (optionnel pour la démo complète)
- Navigateur web moderne

---

## Étape 1 : Démarrer l'Application Vulnérable

```bash
cd vulnerable/backend
npm install
npm start
```

L'application sera accessible sur `http://localhost:3000`

---

## Étape 2 : Se Connecter comme Utilisateur

1. Ouvrir `http://localhost:3000`
2. Identifiants : `user` / `user123`
3. Observer le design "rétro" (vulnérabilité visuelle)

---

## Étape 3 : Extraire le JWT

1. Ouvrir les DevTools (F12)
2. Onglet **Application** > **Cookies**
3. Copier la valeur de `auth_token`

**Observer les flags manquants :**
- Pas de `Secure`
- Pas de `HttpOnly`
- `SameSite` non strict

---

## Étape 4 : Analyser le JWT

1. Aller sur https://jwt.io/
2. Coller le JWT
3. Observer :
   - Header : `"alg": "HS256"`
   - Payload : `"admin": false`

---

## Étape 5 : Bruteforce du Secret (Optionnel)

```bash
# Sauvegarder le JWT dans un fichier
echo "eyJhbGciOiJIUzI1NiI..." > jwt.txt

# Lancer hashcat
hashcat -m 16500 jwt.txt dictionnaire.txt
```

**Résultat attendu :** Le secret `123456` est trouvé en quelques secondes.

---

## Étape 6 : Forger le JWT

```bash
cd exploit
python forge_jwt.py
```

Le script génère un JWT avec `"admin": true`.

---

## Étape 7 : Injecter et Accéder

1. Dans les DevTools > Cookies
2. Remplacer `auth_token` par le JWT forgé
3. Aller sur `/admin`
4. **Accès admin accordé !**

---

## Comparaison avec la Version Sécurisée

```bash
cd secure/backend
npm install
npm start
```

Application sur `http://localhost:3001`

### Différences :
| Aspect | Vulnérable | Sécurisé |
|--------|-----------|---------|
| Algorithme | HS256 | RS256 |
| Secret | "123456" | Clé RSA 2048 |
| Cookie Secure | Non | Oui |
| Cookie HttpOnly | Non | Oui |
| SameSite | Lax | Strict |

### Résultat de l'attaque :
- Bruteforce : **Impossible** (asymétrique)
- Forge JWT : **Échoue** (signature invalide)
- Accès admin : **401 Unauthorized**
